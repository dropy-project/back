// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum MediaType {
  TEXT
  PICTURE
  VIDEO
  MUSIC
}

model User {
  id       Int    @id @default(autoincrement())
  uid    String @unique
  username String @unique
  displayName String
  registerDate DateTime @default(now())
  emittedDropies Dropy[] @relation("emittedDropies")
  receivedDropies Dropy[] @relation("receivedDropies")
}

model Dropy {
  id       Int    @id @default(autoincrement())
  creationDate DateTime @default(now())
  emitterId Int
  receiverId Int?
  emitter     User   @relation("emittedDropies", fields: [emitterId], references: [id], map: "emitterId")
  receiver     User?   @relation("receivedDropies", fields: [receiverId], references: [id], map: "receiverId")
  latitude Float
  longitude Float
  media DropyMedia?
}

model DropyMedia {
  id      Int    @id @default(autoincrement())
  dropy  Dropy @relation(fields: [dropyId], references: [id])
  dropyId Int
  filePath String
  mediaType MediaType
}