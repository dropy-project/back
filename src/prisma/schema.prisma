datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum MediaType {
  NONE
  TEXT
  PICTURE
  VIDEO
  MUSIC
}

model User {
  id                        Int      @id @default(autoincrement())
  uid                       String   @unique
  username                  String   @unique
  displayName               String
  registerDate              DateTime @default(now())
  emittedDropies            Dropy[]  @relation("emittedDropies")
  retrievedDropies          Dropy[]  @relation("retrievedDropies")
  lastSeenDate              DateTime
  lastSeenLocationLongitude Float
  lastSeenLocationLatitude  Float
}

model Dropy {
  id           Int      @id @default(autoincrement())
  creationDate DateTime @default(now())

  emitter   User @relation("emittedDropies", fields: [emitterId], references: [id], map: "emitterId")
  emitterId Int

  retrieverId  Int?
  retriever    User?     @relation("retrievedDropies", fields: [retrieverId], references: [id], map: "retrieverId")
  retrieveDate DateTime?

  latitude  Float
  longitude Float

  filePath  String?
  mediaData String?
  mediaType MediaType @default(NONE)
}
